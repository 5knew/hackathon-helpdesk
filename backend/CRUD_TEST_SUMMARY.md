# ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–π

## üéâ –í–°–ï CRUD –û–ü–ï–†–ê–¶–ò–ò –†–ê–ë–û–¢–ê–Æ–¢!

**–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** 2025-12-05  
**–í–µ—Ä—Å–∏—è API:** 2.0.0  
**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL (helpdesk_db)

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| # | –û–ø–µ—Ä–∞—Ü–∏—è | Endpoint | –ú–µ—Ç–æ–¥ | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|----------|----------|-------|--------|----------|
| 1 | **CREATE** | `/tickets/create` | POST | ‚úÖ | –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞ —Å AI –æ–±—Ä–∞–±–æ—Ç–∫–æ–π |
| 2 | **READ** | `/tickets/{id}` | GET | ‚úÖ | –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞ –ø–æ ID |
| 3 | **READ ALL** | `/tickets` | GET | ‚úÖ | –°–ø–∏—Å–æ–∫ —Ç–∏–∫–µ—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π |
| 4 | **UPDATE** | `/tickets/{id}` | PUT | ‚úÖ | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞ |
| 5 | **DELETE** | `/tickets/{id}` | DELETE | ‚úÖ | –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (soft delete) |

**–ò—Ç–æ–≥–æ: 5/5 –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–∞–±–æ—Ç–∞—é—Ç (100%)**

---

## üîç –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. CREATE ‚úÖ

**Endpoint:** `POST /tickets/create`

**–¢–µ—Å—Ç:**
```bash
curl -X POST "http://localhost:8002/tickets/create" \
  -H "Content-Type: application/json" \
  -d '{
    "source": "email",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "subject": "–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞—è–≤–∫–∞",
    "body": "–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É",
    "language": "ru"
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ
- –¢–∏–∫–µ—Ç —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ë–î

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": "uuid-—Ç–∏–∫–µ—Ç–∞",
  "source": "email",
  "user_id": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "subject": "–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞—è–≤–∫–∞",
  "body": "–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É",
  "status": "new",
  "priority": "high",
  "category_id": "uuid-–∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
  ...
}
```

---

### 2. READ ‚úÖ

**Endpoint:** `GET /tickets/{ticket_id}`

**–¢–µ—Å—Ç:**
```bash
curl "http://localhost:8002/tickets/{ticket_id}"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ
- –¢–∏–∫–µ—Ç –ø–æ–ª—É—á–µ–Ω —É—Å–ø–µ—à–Ω–æ
- –í—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- 404 –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤

---

### 3. READ ALL ‚úÖ

**Endpoint:** `GET /tickets?skip=0&limit=50&status=new`

**–¢–µ—Å—Ç:**
```bash
curl "http://localhost:8002/tickets?skip=0&limit=10"
curl "http://localhost:8002/tickets?status=new"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ
- –°–ø–∏—Å–æ–∫ —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ–ª—É—á–µ–Ω
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (skip, limit)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É —Ä–∞–±–æ—Ç–∞–µ—Ç

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": "uuid-1",
    "subject": "...",
    ...
  },
  {
    "id": "uuid-2",
    "subject": "...",
    ...
  }
]
```

---

### 4. UPDATE ‚úÖ

**Endpoint:** `PUT /tickets/{ticket_id}`

**–¢–µ—Å—Ç:**
```bash
curl -X PUT "http://localhost:8002/tickets/{ticket_id}" \
  -H "Content-Type: application/json" \
  -d '{
    "status": "in_work",
    "priority": "high"
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ
- –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω
- `updated_at` –æ–±–Ω–æ–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- `closed_at` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": "uuid-—Ç–∏–∫–µ—Ç–∞",
  "status": "in_work",
  "priority": "high",
  "updated_at": "2025-12-05T...",
  ...
}
```

---

### 5. DELETE ‚úÖ

**Endpoint:** `DELETE /tickets/{ticket_id}`

**–¢–µ—Å—Ç:**
```bash
curl -X DELETE "http://localhost:8002/tickets/{ticket_id}"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ
- –¢–∏–∫–µ—Ç –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –∑–∞–∫—Ä—ã—Ç—ã–π (soft delete)
- –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `closed`
- `closed_at` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- `updated_at` –æ–±–Ω–æ–≤–ª–µ–Ω

**–û—Ç–≤–µ—Ç:**
```json
{
  "message": "Ticket deleted successfully",
  "ticket_id": "uuid-—Ç–∏–∫–µ—Ç–∞"
}
```

---

## üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| Endpoint | –ú–µ—Ç–æ–¥ | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|--------|----------|
| `/health` | GET | ‚úÖ | Health check |
| `/` | GET | ‚úÖ | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ API |
| `/docs` | GET | ‚úÖ | Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |

---

## üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∏–∫–µ—Ç–∞
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ ML –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω—è—è –∏–ª–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è

### AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–∫–µ—Ç–æ–≤
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –∏ —Ç–∏–ø–∞ –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞–º
- ‚úÖ –ü–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- ‚úÖ –í—Å–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ò–ò —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `ai_predictions`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `ai_auto_responses`
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ `daily_stats`

---

## ‚úÖ –í—ã–≤–æ–¥—ã

**–í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!**

1. ‚úÖ **CREATE** - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤ —Å –ø–æ–ª–Ω–æ–π AI –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
2. ‚úÖ **READ** - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏ —Å–ø–∏—Å–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤
3. ‚úÖ **UPDATE** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π —Ç–∏–∫–µ—Ç–∞
4. ‚úÖ **DELETE** - –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (soft delete)

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (404, 500)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è

1. ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
2. üí° –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
   - –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É (`GET /tickets/search?q=—Ç–µ–∫—Å—Ç`)
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫—É (`GET /tickets?sort=created_at&order=desc`)
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—É)
   - –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –≤ —Ç–∏–∫–µ—Ç–∞—Ö (`/tickets/{id}/messages`)
   - –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (`/stats`, `/metrics`)
   - –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏, –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞–º–∏

---

## üöÄ API –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** 100%  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

---

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:** ‚úÖ  
**–î–∞—Ç–∞:** 2025-12-05  
**–í–µ—Ä—Å–∏—è:** 2.0.0

