"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Backend API —Å–µ—Ä–≤–µ—Ä–∞
"""
import uvicorn
import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –ø—É—Ç—å –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
sys.path.insert(0, os.path.dirname(__file__))

# –Ø–≤–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º app –î–û –∑–∞–ø—É—Å–∫–∞ uvicorn –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
# –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ @app.get, @app.post –∏ —Ç.–¥.
from main import app

if __name__ == "__main__":
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã
    routes = [r.path for r in app.routes if hasattr(r, 'path')]
    print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤: {len(routes)}")
    ticket_routes = [r for r in routes if 'ticket' in r.lower()]
    print(f"‚úÖ –≠–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –¥–ª—è —Ç–∏–∫–µ—Ç–æ–≤: {len(ticket_routes)}")
    
    if '/tickets' not in routes:
        print("‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –≠–Ω–¥–ø–æ–∏–Ω—Ç /tickets –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        print("–î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:", [r for r in routes if 'ticket' in r.lower()])
    else:
        print("‚úÖ –≠–Ω–¥–ø–æ–∏–Ω—Ç /tickets –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
    
    print(f"\nüöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ http://0.0.0.0:8002")
    print(f"üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8002/docs\n")
    
    uvicorn.run(
        app,  # –ü–µ—Ä–µ–¥–∞–µ–º –æ–±—ä–µ–∫—Ç app –Ω–∞–ø—Ä—è–º—É—é, –∞ –Ω–µ —Å—Ç—Ä–æ–∫—É
        host="0.0.0.0",
        port=8002,  # Backend –Ω–∞ –ø–æ—Ä—Ç—É 8002, ML —Å–µ—Ä–≤–∏—Å –Ω–∞ 8000
        reload=False  # –û—Ç–∫–ª—é—á–∞–µ–º reload –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    )

